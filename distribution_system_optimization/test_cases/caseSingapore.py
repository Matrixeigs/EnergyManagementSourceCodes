# Copyright (c) 2017-2018. All rights reserved.
# Use of this source code is governed by a BSD-style
# license that can be found in the LICENSE file.

"""
Distribution system data for Singapore, with medium voltage and low voltage distribution
1) 22 kV distribution network
2) 400V lower voltage distribution network
1 generator case.
"""

from numpy import array

def caseSingapore():
    """Power flow data for Singapore distribution networks, 1 generator case.
    Please see L{caseformat} for details on the case file format.

    Based on data from ...

    @return: Power flow data for 30 bus, 6 generator case.
    @see: U{http://www.pserc.cornell.edu/matpower/}
    """
    ppc = {"version": '2'}

    ##-----  Power Flow Data  -----##
    ## system MVA base
    ppc["baseMVA"] = 100.0

    ## bus data
    # bus_i type Pd Qd Gs Bs area Vm Va baseKV zone Vmax Vmin
    ppc["bus"] = array([
        [1, 3, 0, 0, 0, 0, 1, 1.01, 0, 22, 1, 1.1, 0.9],
        [2, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [3, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [4, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [5, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [6, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [7, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [8, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [9, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [10, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [11, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [12, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [13, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [14, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [15, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [16, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [17, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [18, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [19, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [20, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [21, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [22, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [23, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [24, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [25, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [26, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [27, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [28, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [29, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [30, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [31, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [32, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [33, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [34, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [35, 1, 0, 0, 0, 0, 1, 1, 0, 22, 1, 1.1, 0.9],
        [36, 1, 0.019, 0.0117, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [37, 1, 0.4091, 0.2542, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [38, 1, 0.2609, 0.2030, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [39, 1, 0.5477, 0.2433, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [40, 1, 0.1854, 0.1534, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [41, 1, 0.2601, 0.1461, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [42, 1, 0.4451, 0.1574, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [43, 1, 0.4931, 0.2030, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [44, 1, 0.1863, 0.0677, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [45, 1, 0.3428, 0.1493, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [46, 1, 0.3198, 0.1131, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [47, 1, 0.0682, 0.0219, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [48, 1, 0.2442, 0.0870, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [49, 1, 0.4994, 0.1965, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [50, 1, 0.7175, 0.4061, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [51, 1, 0.6595, 0.4317, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [52, 1, 0.7656, 0.3484, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [53, 1, 0.8735, 0.5519, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [54, 1, 0.8306, 0.2530, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [55, 1, 0.9880, 0.2805, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [56, 1, 0.3466, 0.1630, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [57, 1, 0.1388, 0.0459, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [58, 1, 0.1830, 0.0412, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [59, 1, 0.8396, 0.1907, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [60, 1, 0.0139, 0.0043, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [61, 1, 0.1125, 0.0140, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [62, 1, 0.0861, 0.0162, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [63, 1, 0.7746, 0.3581, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [64, 1, 0.4611, 0.1758, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [65, 1, 0.2422, 0.0595, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [66, 1, 0.0481, 0.0001, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [67, 1, 0.3482, 0.1067, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [68, 1, 0.0007, 0.0008, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [69, 1, 0.3948, 0.1266, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
        [70, 1, 0, 0, 0, 0, 1, 1, 0, 0.4, 1, 1.1, 0.9],
    ])

    ## generator data
    # bus, Pg, Qg, Qmax, Qmin, Vg, mBase, status, Pmax, Pmin, Pc1, Pc2,
    # Qc1min, Qc1max, Qc2min, Qc2max, ramp_agc, ramp_10, ramp_30, ramp_q, apf, start-up time, shut-down time and initial condition!
    ppc["gen"] = array([
        [1, 0, 0, 1000, -1000, 1, 100, 1, 800, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 1],
    ])

    ## branch data
    # fbus, tbus, r, x, b, rateA, rateB, rateC, ratio, angle, status, angmin, angmax
    ppc["branch"] = array([
        [1, 2, 0.009685537, 0.015187438, 0.000184382, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [2, 3, 0.006953719, 0.010903802, 0.000132377, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [3, 4, 0.006208678, 0.009735537, 0.000118194, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [4, 5, 0.011672314, 0.018302810, 0.000222204, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [5, 6, 0.011672314,	0.018302800, 0.000222204, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [6, 7, 0.003228512, 0.005060000, 0.000061500, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [7, 8, 0.007698760, 0.012072066, 0.000146560, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [4, 9, 0.003228512, 0.005060000, 0.000061500, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [9, 10, 0.01713595,	0.026870083, 0.000326215, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [10, 11, 0.009685537, 0.015187438, 0.000184382, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [11, 12, 0.006953719, 0.010903802, 0.000132377, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [12, 13, 0.006208678, 0.009735537, 0.000118194, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [13, 14, 0.011672314, 0.01830281, 0.000222204, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [2, 15, 0.040977273, 0.068543182, 0.000821965, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [15, 16, 0.029801653, 0.049849587, 0.000597793, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [16, 17, 0.010927273, 0.018278182, 0.000219191, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [17, 18, 0.023592975, 0.039464256, 0.000473252, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [18, 19, 0.007947107, 0.013293223, 0.000159411, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [19, 20, 0.022599587, 0.037802603, 0.000453326, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [20, 21, 0.005960331, 0.009969917, 0.000119559, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [21, 22, 0.000993388, 0.001557686, 0.000018900, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [16, 23, 0.004221901, 0.006620165, 0.000080400, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [23, 24, 0.006208678, 0.009735537, 0.000118194, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [24, 25, 0.006953719, 0.010903802, 0.000132377, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [25, 26, 0.004470248, 0.007009587, 0.0000851, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [2, 27, 0.009933884, 0.015576860, 0.00018911, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [27, 28, 0.002980165, 0.004673058, 0.0000567, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [28, 29, 0.009933884, 0.01557686, 0.00018911, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [29, 30, 0.005463636, 0.008567273,0.000104011, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [30, 31, 0.011423967, 0.017913388, 0.000217477, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [31, 32, 0.001986777, 0.003115372, 0.0000378, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [32, 33, 0.006457025, 0.010124959, 0.000122922, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [33, 34, 0.002980165, 0.004673058, 0.0000567, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [34, 35, 0.002980165, 0.004673058, 0.0000567, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [2, 36, 0.71875, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [3, 37, 1.28, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [4, 38, 0.71875, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [5, 39, 0.71875, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [6, 40, 0.71875, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [7, 41, 1.83925422, 0.04, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [8, 42, 1.28, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [9, 43, 1.28, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [10, 44, 1.28, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [12, 46, 1.83925422, 0.04, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [13, 47, 1.28, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [14, 48, 1.28, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [15, 49, 0.71875, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [16, 50, 0.71875, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [17, 51, 0.71875, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [18, 52, 0.71875, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [19, 53, 0.71875, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [20, 54, 0.71875, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [21, 55, 0.71875, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [22, 56, 1.28, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [23, 57, 1.83925422, 0.04, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [24, 58, 1.83925422, 0.04, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [25, 59, 0.71875, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [26, 60, 0.71875, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [27, 61, 1.28, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [28, 62, 1.28, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [29, 63, 0.71875, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [30, 64, 0.71875, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [31, 65, 0.71875, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [32, 66, 1.83925422, 0.04, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [33, 67, 1.28, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [34, 68, 1.28, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [35, 69, 1.28, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360],
        [2, 70, 1.28, 0.06, 0, 9999, 9999, 9999, 0, 0, 1, -360, 360]
    ])

    ##-----  OPF Data  -----##
    ## area data
    # area refbus
    ppc["areas"] = array([
        [1, 1],
    ])

    ## generator cost data
    # 1 startup shutdown n x1 y1 ... xn yn
    # 2 startup shutdown n c(n-1) ... c0
    ppc["gencost"] = array([
        [2, 0, 0, 3, 0.02, 2, 3],
    ])

    return ppc
